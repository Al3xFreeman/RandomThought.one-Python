{% extends "base.html" %}

{% block content %}
    <h1>ONE RANDOM THOUGHT</h1>
    {% if not current_user.is_anonymous %}
    <!--<h1>Hi, {{ current_user.username }}!</h1>-->
    {% endif %}
    {% if not post.author %}
    <h2>Anonymous said:</h2>
    {% else %}
    <h2><a href="{{ url_for('profile', username=post.author.username) }}"> {{ post.author.username }}</a> said:
    </h2>
    {% endif %}

    <p>{{ post.body }}</p>

    <p>Stars: {{ post.stars() }}
    <!--
    {% if post.author %}
        ~ <a href="{{ url_for('profile', username=post.author.username) }}">{{ post.author.username }}</a>
    
    {% else %}
        ~ Anonymous
    {% endif %}
    -->
    </p>
    {% if current_user.is_authenticated %}
        {% if post in current_user.starred_posts %}
            <iframe name="dummyframe" id="dummyframe" style="display: none;"></iframe>
            <form action="/{{post.id}}/unstar" target="dummyframe">
                <input type="submit" value="Remove Star!">
            </form>
        {% else %}
        <iframe name="dummyframe" id="dummyframe" style="display: none;"></iframe>
        <form action="/{{post.id}}/star" target="dummyframe">
            <input type="submit" value="Star!">
        </form>
        {% endif %}
    {% endif %}

    {% if not current_user.is_anonymous %}
    <form action="" method="post">
        {{ form.hidden_tag() }}
        <p>
            {{ form.body.label }}<br>
            {{ form.body(size=128) }}<br>
            {% for error in form.body.errors %}
            <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
        </p>
        <p>{{ form.submit() }}</p>

    </form>
    {% endif %}
{% endblock %}